<form [formGroup]="taskForm" (ngSubmit)="onSubmit()">
  <div class="form-group">
    <div class="input-line">
      <input 
        id="taskTitle" 
        formControlName="title" 
        type="text" 
        class="form-control title-input" 
        placeholder="Title" 
      />
    </div>
    <div *ngIf="taskForm.get('title')?.invalid && submitted" id="taskTitle" class="text-danger">
      Title is required
    </div>
  </div>

  <div class="form-group">
    <textarea id="taskDescription" formControlName="description" class="form-control" placeholder="Description"></textarea>
  </div>

  <div class="form-group">
    <label for="dueDate">Due Date and Time</label>
    <input 
      id="taskDueDate" 
      type="datetime-local" 
      formControlName="dueDate" 
      class="form-control" 
    />
    <div *ngIf="taskForm.get('dueDate')?.invalid && (taskForm.get('dueDate')?.touched || submitted)" class="text-danger">
      <div *ngIf="taskForm.get('dueDate')?.errors?.['required']">Due date and time are required</div>
      <div *ngIf="taskForm.get('dueDate')?.errors?.['pastDate']">Due date and time cannot be in the past</div>
    </div>
  </div>

  <div class="form-group">
    <select id="taskPriority" formControlName="priority" class="form-control">
      <option value="" disabled selected>Select Priority</option>
      <option *ngFor="let option of priorityOptions" [value]="option">{{ option }}</option>
    </select>
    <div *ngIf="taskForm.get('priority')?.invalid && submitted" class="text-danger">
      Priority is required
    </div>
  </div>

  <div class="form-group">
    <select id="taskStatus" formControlName="status" class="form-control">
      <option value="" disabled selected>Select Status</option>
      <option *ngFor="let option of statusOptions" [value]="option">{{ option }}</option>
    </select>
    <div *ngIf="taskForm.get('status')?.invalid && submitted" class="text-danger">
      Status is required
    </div>
  </div>

  <div class="form-group form-check">
    <input 
      type="checkbox" 
      id="taskAddCollaborator" 
      (change)="toggleCollaborator()" 
      class="form-check-input" 
      [checked]="isCollaboratorVisible" 
    />
    <label for="addCollaborator" class="form-check-label">Add Collaborator</label>
  </div>

  <div class="collaborator-box" *ngIf="isCollaboratorVisible">
    <h3>Select Collaborators:</h3>
    <div class="checkbox-list">
      <div *ngFor="let user of users; let i = index" class="checkbox-item">
        <input 
          type="checkbox" 
          (change)="toggleCheckbox(i)" 
          [checked]="selectedCollaborators.includes(user)" /> 
        <label>{{ user.username }}</label>
      </div>
    </div>
  </div>

  <div class="button-group">
    <button id="addTaskButton1" type="submit" class="btn btn-primary">Add Task</button>
    <button id="cancelButton" type="button" (click)="closeTaskForm()" class="btn btn-secondary">Cancel</button>
  </div>
</form>
