<form [formGroup]="taskForm" (ngSubmit)="onSubmit()">
  <div class="form-group">
    <input id="title" formControlName="title" type="text" class="form-control" placeholder="Title" />
    <div *ngIf="taskForm.get('title')?.invalid && submitted" class="text-danger">
      Title is required
    </div>
  </div>

  <div class="form-group">
    <textarea id="description" formControlName="description" class="form-control" placeholder="Description"></textarea>
  </div>

  <div class="form-group">
    <label for="dueDate">Due Date and Time</label>
    <input id="dueDate" type="datetime-local" formControlName="dueDate" class="form-control" />
    <div *ngIf="taskForm.get('dueDate')?.invalid && (taskForm.get('dueDate')?.touched || submitted)" class="text-danger">
      <div *ngIf="taskForm.get('dueDate')?.errors?.['required']">Due date and time are required</div>
    </div>
  </div>

  <div class="form-group">
    <select id="priority" formControlName="priority" class="form-control">
      <option value="" disabled selected>Select Priority</option>
      <option *ngFor="let option of priorityOptions" [value]="option">{{ option }}</option>
    </select>
    <div *ngIf="taskForm.get('priority')?.invalid && submitted" class="text-danger">
      Priority is required
    </div>
  </div>

  <div class="form-group">
    <select id="status" formControlName="status" class="form-control">
      <option value="" disabled selected>Select Status</option>
      <option *ngFor="let option of statusOptions" [value]="option">{{ option }}</option>
    </select>
    <div *ngIf="taskForm.get('status')?.invalid && submitted" class="text-danger">
      Status is required
    </div>
  </div>

  <div class="form-group form-check">
    <input 
      type="checkbox" 
      id="addCollaborator" 
      (change)="toggleCollaborator()" 
      class="form-check-input" 
      [checked]="isCollaboratorVisible" 
    />
    <label for="addCollaborator" class="form-check-label">Add Collaborator</label>
  </div>

  <div class="checkbox-list" *ngIf="isCollaboratorVisible">
    <h3>Select Collaborators:</h3>
    <div *ngFor="let user of users; let i = index" class="checkbox-item">
      <input 
        type="checkbox" 
        (change)="toggleCheckbox(i)" 
        [checked]="selectedCollaborators.includes(user)" /> 
      <label>{{ user.username }}</label>
    </div>
  </div>

  <button type="submit" class="btn btn-primary">Submit</button>
  <button type="button" (click)="closeTaskForm()" class="btn btn-secondary">Cancel</button>
</form>